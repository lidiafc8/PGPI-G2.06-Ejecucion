{% extends "base.html" %}
{% block breadcrumbs %}
    </li>
    
    <li>
        <span class="text-lg text-gray-500">></span>
        <span class="text- font-medium text-gray-500 hover:text-[#bf7149]">
            CARRITO
        </span>
    </li>
{% endblock breadcrumbs %}
{% block content %}
{% load static %}
<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    
    <h1 class="text-3xl font-bold text-gray-800 mb-6">Tu Carrito</h1>
            <hr class="mb-8">

    
    <div class="flex flex-col lg:flex-row gap-8">
        
        <div class="lg:w-2/3">
            
            {% if articulos %}
                {% for articulo in articulos %}
                    <div class="bg-white p-4 rounded-lg shadow-sm border border-gray-200 mb-4 flex items-start">
                        
                        <div class="flex-shrink-0 mr-4">
                            <img src="{{ articulo.imagen_url }}" alt="{{ articulo.nombre }}" class="w-24 h-24 object-cover rounded-md border border-gray-100">
                        </div>

                        <div class="flex-grow flex flex-col sm:flex-row justify-between sm:items-center">
                            
                            <div class="mb-2 sm:mb-0 sm:w-6/12">
                                <p class="text-lg font-semibold text-gray-800">{{ articulo.nombre }}</p>
                                <p class="text-sm text-gray-500 mt-1">Precio/ud: {{ articulo.precio_unidad|floatformat:2 }} â‚¬</p>
                            </div>
                            
                            {% if articulo.stock > 0 %}
                                <div class="flex items-center space-x-2 sm:w-3/12 justify-center mt-2 sm:mt-0">
                                    
                                    <form action="{% url 'carrito:update_cart' producto_id=articulo.id %}?" method="POST" class="inline-block">
                                        {% csrf_token %}
                                        <input type="hidden" name="action" value="remove">
                                        <button type="submit" class="text-gray-500 hover:bg-gray-100 border border-gray-300 w-8 h-8 flex items-center justify-center rounded-l">
                                            -
                                        </button>
                                    </form>

                                    <span class="border border-gray-300 px-1 py-1 text-center text-sm font-medium w-12">
                                        {{ articulo.cantidad }}
                                    </span>
                                    
                                    <form action="{% url 'carrito:update_cart' producto_id=articulo.id %}?action=add" method="POST" class="inline-block">
                                        {% csrf_token %}
                                        <input type="hidden" name="action" value="add">
                                        <button type="submit" class="text-green-600 hover:bg-gray-100 border border-gray-300 w-8 h-8 flex items-center justify-center rounded-r">
                                            +
                                        </button>
                                    </form>
                                </div>
                            {% else %}
                                <p class="text-sm font-bold text-red-600">Â¡AGOTADO!</p>
                            {% endif %}
                        </div>
                        
                        <div class="ml-auto text-right flex flex-col items-end">
                            <form action="{% url 'carrito:remove_from_cart' producto_id=articulo.id %}" method="POST" class="inline-block">
                                {% csrf_token %}
                                <button type="submit" class="text-gray-400 hover:text-red-500 mb-4">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 100 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 6h6v10H7V6z" clip-rule="evenodd" /></svg>
                                </button>
                            </form>
                            {% if articulo.stock > 0 %}
                            <p class="text-xl font-bold text-gray-800">{{ articulo.precio_total|floatformat:2 }} â‚¬</p>
                            {% endif %}
                        </div>
                        
                    </div>
                {% endfor %}
                
            {% else %}
                <div class="bg-white border border-gray-300 p-6 rounded-lg text-center shadow-sm mb-6">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10 text-gray-400 mx-auto mb-3" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z" /></svg>
                    <p class="text-xl font-semibold text-gray-700">Â¡Tu carrito estÃ¡ vacÃ­o! ðŸ›’</p>
                    <p class="text-gray-500 mt-2">No hay artÃ­culos en la cesta.</p>
                </div>
            {% endif %}
            
        </div>
        
        <div class="lg:w-1/3 space-y-4">
            
            <div class="bg-gray-100 p-4 rounded-lg space-y-2">
                <div class="flex justify-between text-sm text-gray-700">
                    <span>Subtotal</span>
                    <span class="font-medium">{{ subtotal }} â‚¬</span>
                </div>
                <div class="flex justify-between text-sm text-gray-700">
                    <span>Gastos de envÃ­o estimados: continuar proceso de compra</span>

                </div>
                <div class="h-px bg-gray-300 my-3"></div> 
                
                <div class="flex justify-between items-center pt-2">
                    <span class="text-xl font-bold text-gray-800">Total</span>
                    <span class="text-2xl font-extrabold text-gray-800">{{ total }} â‚¬</span>
                </div>
            </div>
            
            <div class="space-y-2">
    {% if articulos %}
    <a href="{% url 'carrito:checkout' %}">
        <button class="w-full bg-[#6a760c] hover:bg-[#bf7149] text-white font-bold py-3 rounded-md transition duration-150">
            Continuar al Pago
        </button>
    </a>
    {% else %}
    <button class="w-full bg-gray-400 text-white font-bold py-3 rounded-md " disabled>
        Continuar al Pago
    </button>
    {% endif %}
    <a href="{% url 'home' %}">
        <button class="w-full py-2 bg-white text-[#bf7149] font-semibold rounded-md 
                    border-2 border-[#bf7149] hover:bg-[#bf7149] hover:text-white 
                    transition duration-150 relative z-10 mt-2">
            Seguir Comprando
        </button>
    </a>
</div>
            
        </div>
        
    </div>

</div>
{% endblock content %}